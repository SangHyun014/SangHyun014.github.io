---
layout: post
title: ëŒ€í‘œì ì¸ CNN êµ¬ì¡°ë“¤
categories: [Computer Vision]
tags: [Computer Vision, CNN, LeNet, AlexNet, VGGNet, GoogLeNet, ResNet]
---




- ì œì•ˆëœ CNN Network êµ¬ì„±ì€ ë‹¤ì–‘í•˜ë©°, ì±…ì€ LeNetê³¼ AlexNet ì„ ì„¤ëª…í•˜ê³  ìˆìœ¼ë©°, ì´ì™¸ì—ë„ VGGNet, GoogleNet, ResNet ë“±ì´ ìˆë‹¤.
1. [LeNet]
2. [AlexNet]
3. [VGGNet]
4. [GoogleNet]
5. [ResNet]


## LeNet


 ë¨¼ì €, LeNetì— ëŒ€í•´ ì´ì•¼ê¸° í•´ë³´ì. LeNetì€ 1990ë…„ëŒ€ì— ë§Œë“¤ì–´ì§„ ê²ƒìœ¼ë¡œ, 1~5ê¹Œì§€ ìˆë‹¤.

ìš°ë¦¬ëŠ” ì±…ì— ìˆëŠ” LeNet-5ì— ëŒ€í•´ì„œë§Œ ë‹¤ë£° ê²ƒì´ë‹¤.

![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/4a26b794-4264-4c62-8a5b-0798b36f711f)


LeNetì˜ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- Conv Layer 3ê°œ, Subsampling Layer(Average Pooling) 2ê°œ, FC Layer 1ê°œë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.

1) C1 Layer : 32x32 ì´ë¯¸ì§€ë¥¼ inputìœ¼ë¡œ ë°›ì•„, 6ê°œì˜ 5x5 Convolutionì„ í†µí•´, 6ê°œì˜ 28x28 feature mapì„ ì–»ëŠ”ë‹¤.

2) S2 Layer : ì´ë¥¼ 2x2 Subsampling(Average Pooling)ì„ í†µí•´ 6ê°œì˜ 14*14 Feature mapì„ ì–»ëŠ”ë‹¤.

ì´ë¥¼ í†µí•´ 28x28 Feature mapì´ 14x14ë¡œ ì¶•ì†Œëœë‹¤.

3) C3 Layer : 5x5 Convolutionì„ í†µí•´ 10x10 Feature map 16ê°œë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.

4) S4 Layer : ë™ì¼í•œ Samplingê³¼ì •ì„ ê±°ì³ 16ê°œì˜ 5x5 Feature mapì„ ë§Œë“¤ì–´ë‚¸ë‹¤.

5) C5 Layer : ì´ë²ˆì—ë„ 5x5 Convolution ì—°ì‚°ì„ ì§„í–‰í•˜ê²Œ ë˜ë©°, 1x1 Feature map 120ê°œë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.

6) F6 Layer : 120ê°œì˜ Feature mapì„ 84ê°œì˜ FC Layerì— ì—°ê²°í•œë‹¤.ë§ˆì§€ë§‰ìœ¼ë¡œ 10ê°œì˜ Gausian Layerì™€ ì—°ê²°í•˜ì—¬ 10ê°œì˜ Classë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

- íŒŒë¼ë¯¸í„° ìˆ˜ ê³„ì‚°í•˜ê¸°
    
    Convolution Parameter : (ê°€ì¤‘ì¹˜ * ì…ë ¥ë§µ ê°œìˆ˜ + ë°”ì´ì–´ìŠ¤) * íŠ¹ì„±ë§µ ê°œìˆ˜
    
    Subsampling Parameter : (ê°€ì¤‘ì¹˜ + ë°”ì´ì–´ìŠ¤) * íŠ¹ì„±ë§µ ê°œìˆ˜
    
    FC parameter : (ì…ë ¥ê°œìˆ˜ + ë°”ì´ì–´ìŠ¤) * ì¶œë ¥ê°œìˆ˜
    
    1. C1 Layer : (5*5*1 + 1)*6 = 156
    2. S2 Layer : (1+1)*6 = 12
    3. C3 Layer : 
    
    ![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/25c94153-7717-4adb-b24f-dd5142b20007)
    
    ì•ì˜ 6ê°œì˜ Feature mapì—ì„œ ì¡°í•©ì„ í†µí•´ 16ì¥ì˜ íŠ¹ì„±ë§µì„ ì–»ì€ ì¡°í•©í‘œì´ë‹¤.
    
    1. (5*5*3+1)*6 = 456
    2. (5*5*4+1)*9 = 909
    3. (5*5*6+1)*1 = 151
    
    ì´ 456+909+151=1516
    
    1. S4 Layer : (1 + 1)*16 = 32
    2. C5 Layer : (5*5*16 + 1)*120 =48120
    3. F6 Layer : (120 + 1)*84 = 10164
    
    ì´ 156+12+1516+32+48120+10164 = 60000 ê°œì˜ íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.
    
    <aside>

    ```
    ğŸ’¡ í˜„ì¬ì˜ CNNê³¼ ì°¨ì´ì ì´ë¼ í•œë‹¤ë©´, LeNetì€ Sigmoid í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ê³ , í˜„ì¬ëŠ” ì£¼ë¡œ ReLUë¥¼ ì‚¬ìš©í•œë‹¤. ë˜í•œ, LeNetì€ Subsaplingì„, í˜„ì¬ëŠ” Max-Poolingì„ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì¶•ì†Œì‹œí‚¨ë‹¤.
    ```

    </aside>
    

- Average Poolingì´ë€? ì™œ Average Poolingì„ ì‚¬ìš©í–ˆëŠ”ê°€?
    - Pooling ì—°ì‚°ì„ í•˜ëŠ” ë°©ë²•ì€ ë™ì¼í•©ë‹ˆë‹¤. ë§Œì•½ Max-Poolingì´ë¼ í•œë‹¤ë©´ í–‰ë ¬ ìš”ì†Œë“¤ì˜ ê°’ ì¤‘ ê°€ì¥ í° ê°’ì„ ì‚¬ìš©í•œë‹¤ë©´, ê° ìš”ì†Œë“¤ì˜ í‰ê·  ê°’ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ Average Poolingì´ë¼ í•©ë‹ˆë‹¤.
    - ìš°ì„  Average Poolingì„ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ë¹„êµì  ëœ ì¤‘ìš”í•œ ìš”ì†Œë¥¼ í¬í•¨í•  ìˆ˜ ìˆëŠ”ë° ê·¸ë ‡ê²Œ ëœë‹¤ë©´, ì „ì²´ì ì¸ ë¶„ì‚°ì„ ì´ìš©í•  ìˆ˜ ìˆê²Œëœë‹¤.
    â†’ì¦‰, Object Detection ë¶„ì•¼ì—ì„œ í‰ê· ê³¼ ë¶„ì‚°ì˜ ê°œë…ì„ í™œìš©í•˜ì—¬ ë¬¼ì²´ ìœ„ì¹˜ë¥¼ ë³´ë‹¤ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
- ì™œ Gaussian Layerë¥¼ ì‚¬ìš©í–ˆëŠ”ê°€?
    - Gausian LayerëŠ” ë§ˆì§€ë§‰ ê°ì²´ë¥¼ Classificationí•  ë•Œ ì‚¬ìš©í•˜ëŠ” Layer ì…ë‹ˆë‹¤. ì¦‰, â€˜ê°ì²´ì˜ ë¶„í¬ê°€ ì–´ëŠ ìœ„ì¹˜ì— ìˆëŠ”ê°€?â€™ì— ë”°ë¼ í•´ë‹¹ ê°ì²´ë¥¼ ë¶„ë¥˜í•œë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.
    - ì´ëŠ” ë…¼ë¬¸ì—ì„œëŠ” Gaussian Layerë¥¼ ì‚¬ìš©í–ˆë‹¤ê³ ëŠ” í•˜ì§€ë§Œ ë…¼ë¬¸ êµ¬í˜„ì„ í•˜ëŠ” ë¶„ë“¤ì€ Gaussian Layerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  Softmax ë¥¼ ì‚¬ìš©í•˜ì—¬ Classificationì„ ì§„í–‰í•˜ê³  ì´ë ‡ê²Œ í•´ë„ ë¬´ê´€í•˜ë‹¤ë¼ê³  í•©ë‹ˆë‹¤.

## AlexNet


2012ë…„ ê°œìµœëœ ILSVRCëŒ€íšŒì— ìš°ìŠ¹ì„ ì°¨ì§€ CNN êµ¬ì¡°ì´ë‹¤. LeNetê³¼ì˜ êµ¬ì¡° í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šì§€ë§Œ, 2ê°œì˜ GPUë¡œ ë³‘ë ¬ êµ¬ì¡°ë¡œ ì„¤ê³„ë˜ì—ˆë‹¤.
![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/950d395d-7f58-4e5a-8dc7-ad8a85e1e65c)

AlexNet ì˜ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- Convolution Layer 5ê°œ, FC Layer 3ê°œë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.
- Activation Fuctionìœ¼ë¡œ ReLUë¥¼ ì‚¬ìš©í•œë‹¤.
    - Why?
    - AlexNet ì´ì „ì—ëŠ” ë³´í¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ì—ˆë˜ í™œì„±í•¨ìˆ˜ê°€ tanh í•¨ìˆ˜ ì…ë‹ˆë‹¤.
        
        ReLUë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ì„œ í•™ìŠµ ì†ë„ê°€ í–¥ìƒë¨ì„ ë³¼ ìˆ˜ ìˆì—ˆê³ , tanhê³¼ ë¹„êµí–ˆì„ ë•Œ, ì•½ 7ë°° ê°€ê¹Œì´ ë¹¨ëê¸° ë•Œë¬¸ì— ì´ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
        
        ![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/3fc4a48e-313d-4c52-8974-c2ea37d63478)
        
- ê·¸ë¦¼ì—ì„œ ë³´ì´ë“¯ì´ 2,4,5ë²ˆì§¸ Convolutionì—ì„œëŠ” ê°™ì€ Channelì˜ Feature mapê³¼ ì—°ê²°ë˜ì–´ ìˆì§€ë§Œ, 3ë²ˆì§¸ Convolutionì—ì„œëŠ” ë‘ Channel ëª¨ë‘ ì—°ê²°ë˜ì–´ ìˆë‹¤.
- Input imageê°€ ê·¸ë¦¼ì—ì„  224ë¡œ í‘œê¸°ë˜ì–´ ìˆì§€ë§Œ, ì˜¤íƒ€ë¡œ 227x227 sizeì˜ Inputì„ ê°€ì§„ë‹¤.
- 1st Conv Layer
    - 96ê°œì˜ 11x11x3 Sizeë¡œ Convolutionì„ ì§„í–‰í•œë‹¤.(Stride=4, zero-padding(x)) 
    â†’ 55x55x48 Feature mapì„ ë‘ ê°œ ê°€ì§.(GPUê°€ 2ê°œ ì´ë¯€ë¡œ ë³‘ë ¬ ì—°ì‚°ì„ ìœ„í•´ 2ê°œë¡œ ë‚˜ëˆˆë‹¤.)
    - 3x3 Overlapping Max-Pooling (stride=2)ë¡œ ì§„í–‰í•¨.
    â†’ 27x27x48 ì˜ Feature mapì„ ê°€ì§.
    - Local Response Normalizationì„ ì‹œí–‰.
    - ì¶”ê°€ë¡œ, GPUê°€ ë‘ ê°œ ì´ë¯€ë¡œ 55x55x48 ë‘ ê°œë¡œ ë‚˜ëˆ„ì–´ ì§„ë‹¤.
- 2nd Conv Layer
    - 128ê°œì˜ 5x5x48 ì»¤ë„ì„ ë‘ ë²ˆ ì‚¬ìš©í•˜ì—¬, Convolutionì„ ì§„í–‰í•œë‹¤.(stride=1, zero-padding=2)
    â†’ 27x27x128 Feature mapì„ ë‘ ê°œ ê°€ì§.
    - 3x3 Overlapping Max-Pooling (stride=2)ë¡œ ì§„í–‰
    â†’ 13x13x128x2 Feature mapì„ ê°€ì§.
    - LRNì„ ì‹œí–‰
- 3rd Conv Layer
    - 384ê°œì˜ 3x3x256 ì»¤ë„ì„ ì‚¬ìš©í•˜ì—¬ Convolutionì„ ì§„í–‰(ë‘ Channel ëª¨ë‘ì™€ ì—°ê²°ë˜ì–´ ìˆì–´, í•œ Channel ë‹¹ 3x3x128x2ê°œì˜ Feature mapì„ Convolutioní•œë‹¤. )(stride=1, zero-padding=1)
    â†’ 13x13x192x2ì˜ Feature mapì„ ê°€ì§„ë‹¤.
- 4th Conv Layer
    - 192ê°œì˜ 3x3x192 ì»¤ë„ì„ 2ë²ˆ ì‚¬ìš©í•˜ì—¬ Convolutionì„ í•¨.(stride,zero-padding=1)
    â†’13x13x192x2 Feature mapì„ ê°€ì§
- 5th Conv Layer
    - 128ê°œì˜ 3x3x192ë¥¼ Channel ë‹¹ 1ë²ˆì”© 2ë²ˆ Convolution  í•´ì¤€ë‹¤.(stride, zero-padding=1)
    â†’ 13x13x128x2 Feature mapì„ ê°€ì§
    - 3x3 Overlapping Max-Poolingì§„í–‰(stride=2)
    â†’ 6x6x128x2 Feature mapì„ ê°€ì§
- 6th FC Layer
    - 6x6x256 Feature mapì„ Flatten í•˜ì—¬ 1ì°¨ì› 9216ê°œì˜ vectorë¡œ ë§Œë“ ë‹¤.
    - ì´ë¥¼ 4096ê°œì˜ ë‰´ëŸ°ê³¼ Fully Connected í•œë‹¤.(ì±„ë„ë‹¹ 2048ê°œ)
- 7th FC Layer
    - ë™ì¼í•˜ê²Œ 4096ê°œì˜ ë‰´ëŸ°ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ì „ ë‹¨ê³„ì˜ 4096ê°œë¥¼ Fully Connectedí•œë‹¤.
- 8th FC Layer
    - 1000ê°œì˜ ë‰´ëŸ°ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ 4096ê°œì˜ ë‰´ëŸ°ê³¼ Fully Connectedí•œë‹¤.
    - ì¶œë ¥ ê°’ì— softmax í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ 1000ê°œì˜ Class ì— ì†í•  í™•ë¥ ì„ ë‚˜íƒ€ë‚¸ë‹¤.

- Non-overlapping vs overlapping

Convolution ì—°ì‚° ì‹œ, ê²¹ì¹˜ê²Œ í•  ê²ƒì¸ì§€ í˜¹ì€ ê²¹ì¹˜ì§€ ì•Šê²Œ í•  ê²ƒ ì¸ì§€ ì˜ë¯¸í•œë‹¤.

![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/5f53a35d-8005-4bf5-af01-aead619a4dbe)

Overlapping Pooling ì—°ì‚°ì„ í•˜ê²Œ ë˜ë©´ Stride ê³¼ì •ì„ í•  ë•Œ windowê°€ ê²¹ì¹˜ë©´ì„œ ê³„ì‚°ë˜ì–´ ë†“ì¹˜ëŠ” ë¶€ë¶„ì´ Non-Overlapping Poolingì— ë¹„í•´ ì ê²Œ ë©ë‹ˆë‹¤.

ì´ë¡œ ì¸í•´ ì •í™•ë„ê°€ ì•½ê°„ í–¥ìƒë¨ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¬¼ë¡  ë‹¨ì ìœ¼ë¡œëŠ” ê·¸ë§Œí¼ì˜ ì—°ì‚°ëŸ‰ì´ ì¦ê°€í•˜ê²Œ ë©ë‹ˆë‹¤.

AlexNetì˜ ê²½ìš° Overlapping Pooling  ì—°ì‚°ì„ í•¨ìœ¼ë¡œì¨ ì•½ 0.4%ì˜ ì •í™•ë„ í–¥ìƒì„ ì–»ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤.

- Local Response Normalization(LRN)

ì¼ë‹¨ AlexNetì—ì„œ ì‚¬ìš©í•œ LRNì„ ìì„¸íˆ ì‚´í´ë³´ë©´ Local Response Normalization layer implements the lateral inhibition í•œë‹¤ê³  í•©ë‹ˆë‹¤.

ì—¬ê¸°ì„œ lateral inhibition(ì¸¡ë©´ ì–µì œ)ê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

ì¸¡ë©´ì–µì œëŠ” ì‹ ê²½ìƒë¦¬í•™ ìš©ì–´ë¡œ, í•œ ì˜ì—­ì— ìˆëŠ” ì‹ ê²½ ì„¸í¬ê°€ ìƒí˜¸ ê°„ ì—°ê²°ë˜ì–´ ìˆì„ ë•Œ í•œ ê·¸ ìì‹ ì˜ ì¶•ìƒ‰ì´ë‚˜ ìì‹ ê³¼ ì´ì›ƒ ì‹ ê²½ì„¸ë¥¼ ë§¤ê°œí•˜ëŠ” ì¤‘ê°„ì‹ ê²½ì„¸í¬(interneuron)ë¥¼ í†µí•´ ì´ì›ƒì— ìˆëŠ” ì‹ ê²½ ì„¸í¬ë¥¼ ì–µì œí•˜ë ¤ëŠ” ê²½í–¥ì´ë¼ê³  í•©ë‹ˆë‹¤.

AlexNetì—ì„œ ì´ëŸ¬í•œ ì¸¡ë©´ì–µì œë¥¼ ì‚¬ìš©í•œ ì´ìœ ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

ReLUë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ReLUì˜ íŠ¹ì„±ì¸ ì–‘ìˆ˜ê°’ì„ ê·¸ëŒ€ë¡œ ë°›ì•„ ì‚¬ìš©í•˜ê²Œ ë˜ì–´ ë§¤ìš° ë†’ì€ pixel ê°’ì„ ê°€ì§€ëŠ” ê³³ì´ ì£¼ë³€ pixelì— ì˜í–¥ì„ ì£¼ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¶€ë¶„ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì£¼ë³€ì— ìˆëŠ” pixelë¼ë¦¬ normalizationì„ ì§„í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.

- Dropout

ê³¼ì í•©(Overfitting) ë°©ì§€ë¥¼ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ë‰´ëŸ°ì˜ ì¼ë¶€ë¥¼ ìƒëµí•˜ê³  í•™ìŠµì„ ì§„í–‰í•œë‹¤.

![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/b3ff76f1-7f01-44e5-8e32-0593cd29e410)

- Data augmentation

ê³¼ì í•©(overfitting) ë°©ì§€ë¥¼ ìœ„í•´ Data ì–‘ì„ ëŠ˜ë ¤ ë°©ì§€í•˜ê³ ì ëŒ€ì¹­, Crop ë“±ê³¼ ê°™ì€ ê¸°ë²•ì„ ì´ìš©í•´ Dataì–‘ì„ ëŠ˜ë ¸ë‹¤.

ì•„ë˜ì˜ CNN êµ¬ì¡°ë“¤ì€ ì¸µì´ ê¹Šì–´ì§€ë©´ì„œ Layer í•˜ë‚˜ì”© ì‚´í´ë³´ê¸° ë³´ë‹¤ëŠ” ê° êµ¬ì¡°ì˜ íŠ¹ì§•ë“¤ì„ ìì„¸íˆ ì‚´í´ë³´ë„ë¡ í•˜ì.

## VGGNet

![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/76744add-eb4b-4a78-a3d4-a6cd2507f8fc)

VGGNetì€ Layer ì¸µì˜ ê°œìˆ˜ì— ë”°ë¼ VGG-16 / VGG-19ë¡œ ë‚˜ëˆ„ì–´ì§„ë‹¤.

ì•ì„œ ì´ì•¼ê¸°í•œ LeNetê³¼ AlexNetì˜ ì¸µì€ ë¹„êµì  ì‘ì•˜ì§€ë§Œ ì•ìœ¼ë¡œ ë³´ëŠ” ê²ƒë“¤ì€ ì ì  ê¹Šì€ ì¸µì„ ê°€ì§€ê²Œ ëœë‹¤.

VGGNetì€ ì˜¤ì§ depthê°€ í•™ìŠµì— ì£¼ëŠ” ì˜í–¥ë ¥ì„ ì•Œê¸° ìœ„í•´ 3x3 filter(stride=1)ë¡œ ì§„í–‰í•˜ê³ , 2x2 MaxPooling(stride=2)ë¡œ í•™ìŠµì„ ì§„í–‰í•˜ì˜€ë‹¤.

depthê°€ ê¹Šì–´ì§ˆìˆ˜ë¡ ì„±ëŠ¥ì€ ë†’ì•„ì§ˆ ìˆ˜ ìˆì§€ë§Œ, íŒŒë¼ë¯¸í„°ê°€ ì¦ê°€í•˜ì—¬ Overfittingì´ ë°œìƒí•  ìˆ˜ ìˆê³  ì—°ì‚°ëŸ‰ì´ ë§ì•„ì ¸ í•™ìŠµ ì‹œê°„ì´ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆë‹¤.

- ì™œ 3x3 Convolution ë§Œì„ ì‚¬ìš©í•˜ì—¬ ì¸µì„ ìŒ“ì•˜ì„ê¹Œ?
    - ìš°ì„  3x3 Convolutionì´ ìƒí•˜ì¢Œìš°ì˜ ê°œë…ì„ ëª¨ë‘ ì¡ì„ ìˆ˜ ìˆëŠ” ê°€ì¥ ì‘ì€ ì»¤ë„ì…ë‹ˆë‹¤.
    - 5x5 í˜¹ì€ 7x7 Convolutionê³¼ ë™ì¼í•œ sizeì˜ Feature Mapì„ ë§Œë“¤ê¸° ìœ„í•´ì„  2ë²ˆ í˜¹ì€ 3ë²ˆ Convolution  ì—°ì‚°ì„ í•´ì•¼í•œë‹¤. ì¦‰, ReLU í•¨ìˆ˜ë¥¼ 2~3ë²ˆ ì—°ì‚°ì— ì‚¬ìš©ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. 1ë²ˆ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ë‹¬ë¦¬ 3ë²ˆì„ ì‚¬ìš©í•˜ì—¬ ë¹„ì„ í˜•ì„±ì„ ë†’ì¼ ìˆ˜ ìˆì–´ ë”ìš± ì°¨ë³„ì ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - íŒŒë¼ë¯¸í„° ìˆ˜ë¥¼ ì¤„ì—¬ ì—°ì‚°ëŸ‰ì´ ê°ì†Œí•©ë‹ˆë‹¤.
    â†’ 3x3 Convolution â‡’ $3(3^2C^2) = 27C^2$
    â†’ 7x7 Convolution â‡’ $7^2C^2 = 49C^2$  ~> ì•½ 81%ë” ë§ë‹¤.

- FC layerë¡œ ì™œ 4096ê°œë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?
    - ì•„ì£¼ ì¢‹ì€ feature representationìœ¼ë¡œ ì•Œë ¤ì ¸ìˆë‹¤ê³  í•©ë‹ˆë‹¤.
    - ë‹¤ë¥¸ ë°ì´í„°ì—ì„œë„ feature ì¶”ì¶œì´ ì˜ë˜ë©°, ë‹¤ë¥¸ Taskì—ì„œë„ ì¼ë°˜í™” ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤.

## GoogleNet

![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/f38a5ada-3f86-4498-8180-26825a3318f0)

Googlenetì€ ì´ 22ê°œìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.

GoogleNetì˜ ì£¼ìš”í•œ íŠ¹ì„± 4ê°€ì§€ë¥¼ ì‚´í´ë³´ë„ë¡ í•˜ì.

1. 1x1 Convolution
    
    GoogleNetì—ì„œ ì‚¬ìš©í•œ 1x1 Convolutionì€ ìœ ì˜ë¯¸í•˜ê²Œ ì—°ì‚°ëŸ‰ì„ ê°ì†Œì‹œì¼°ìŠµë‹ˆë‹¤. ì´ì— ë”°ë¼ ë‹¤ì–‘í•œ ëª¨ë¸ì—ì„œ 1x1 Convolutionì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.
    
    1x1 Convolutionì€ í¬ê²Œ 3ê°€ì§€ ì¥ì ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
    
    1. Channel ìˆ˜ ì¡°ì ˆ
    2. ì—°ì‚°ëŸ‰ ê°ì†Œ
    3. ë¹„ì„ í˜•ì„± ì¦ê°€
    
    1. Channel ìˆ˜ ì¡°ì ˆ
        1. Convolutionì„ í•  ë•Œ, í° Channelì„ ì‚¬ìš©ì„ í•˜ê²Œ ë˜ë©´ íŒŒë¼ë¯¸í„° ìˆ˜ì˜ ì¦ê°€ ë•Œë¬¸ì— ë¬¸ì œê°€ ë°œìƒí•œë‹¤.
        2. ì´ ë•Œ, 1x1 Convolutionì„ ì´ìš©í•˜ë©´, ì›í•˜ëŠ” Channelì„ ê°€ì§€ëŠ” Feature mapì„ ë§Œë“¤ì–´ ë‚¼ ìˆ˜ ìˆë‹¤.
            
            ![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/1f1fe9cb-46eb-461a-ac75-b08c08213f80)
            
        
        ë‹¤ìŒ ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ 28x28x128 ì„ 1x1 convolutionì„ í†µí•´ 28x28x32ë¡œ ë§Œë“¤ì–´ ëƒˆë‹¤.
        
    2. ì—°ì‚°ëŸ‰ ê°ì†Œ
        
        ![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/d5ed76b7-b363-4bc2-86f1-d6e627e6b404)
        
        ë‹¤ìŒ ê·¸ë¦¼ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´ ìµœì¢… Feature mapì€ 14x14x48ë¡œ ë™ì¼í•¨ì„ ë³¼ ìˆ˜ ìˆì§€ë§Œ ì¤‘ê°„ 1x1 Convolutionì´ ì—°ì‚°ëŸ‰ì´ ì••ë„ì ìœ¼ë¡œ ì¤„ì–´ë“¦ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
        
    3. ë¹„ì„ í˜•ì„± ì¦ê°€
        1. ê¸°ë³¸ì ìœ¼ë¡œ Convolutionì„ ì§„í–‰í•  ë•Œ, í™œì„±í•¨ìˆ˜ë¡œ ReLUë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ëª¨ë¸ì˜ ë¹„ì„ í˜•ì„±ì„ ì¦ê°€ì‹œì¼œì¤ë‹ˆë‹¤.(ReLUë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ  ì¤‘ í•˜ë‚˜)
        â†’ëª¨ë¸ì˜ íŒ¨í„´ì„ ì˜ ì¸ì‹í•œë‹¤.
        2. ì´ ë•Œ, 1x1 Convolutionì„ ì§„í–‰í•˜ê²Œ ë˜ë©´ íŒŒë¼ë¯¸í„° ìˆ˜ëŠ” ê°ì†Œí•˜ê²Œ ë˜ê³ , í™œì„±í•¨ìˆ˜ë¡œ ReLUë¥¼ ì„ íƒí•˜ì—¬ ë¹„ì„ í˜•ì„±ì„ ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
        
2. Inception Module
    - í•˜ë‚˜ì˜ ë ˆì´ì–´ì—ì„œ 1x1, 3x3, 5,5 Convolutionê³¼ 3x3 Maxpoolingì„ concat í•´ì¤€ë‹¤.
    â†’ ì¢€ ë” ë‹¤ì–‘í•œ íŠ¹ì„±ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.
    
    ![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/27dd8888-dcd2-45f5-8666-f6206c1352d4)
    
3. Global Average Pooling
    - í›„ë°˜ë¶€ì— ì¼ë°˜ì ìœ¼ë¡œëŠ” FC layerê°€ ìˆì§€ë§Œ, GoogleNetì€ Global Average Poolingì„ ì‚¬ìš©í–ˆë‹¤
    â†’ ê°€ì¤‘ì¹˜ì˜ ê°œìˆ˜ê°€ ë§ì´ ì—†ì–´ì§„ë‹¤.(FC ë°©ì‹ : 51.3M Global : 0)
    â†’ ì—°ì‚°ëŸ‰ì´ ì¤„ì–´ë“ ë‹¤.
    
    ![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/84c838aa-85cf-48c8-aca3-7a9ab70750a5)
    
4. auxiliary classifier
    
    ![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/2f106705-bc18-46ed-9d74-753eddd53d60)
    
    - ì¸µì´ ê¹Šì–´ì§€ë©´ì„œ ìƒê¸°ëŠ” Vanishing Gradientë¥¼ ë°©ì§€í•˜ê³ ì ì‚¬ìš©.
    - ì˜¤ì°¨ì—­ì „íŒŒ ê³„ì‚° ì‹œ, weight ê°’ì— í° ì˜í–¥ì„ ì£¼ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´ axiliary classifierì— 0.3ì„ ê³±í•œë‹¤.
    - Train í•  ë•Œ ë°œìƒí•˜ëŠ” Vanishing Gradientë¥¼ ë°©ì§€í•˜ê³ ì ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— Testë¥¼ ì§„í–‰í•  ë•ŒëŠ” ì œê±°í•˜ê³  ì‚¬ìš©í•œë‹¤.

VGGNetê³¼ ê°™ì€ ì‹œê¸°ì— ë‚˜ì™€ 1ë“±ì„ ê¸°ë¡í–ˆì§€ë§Œ, ë³µì¡í•œ êµ¬ì¡°ë¡œ ì¸í•´ VGGNetì„ ë” ì„ í˜¸í•´ì„œ ì‚¬ìš©í•˜ê²Œëœë‹¤.

## ResNet(ì¡°ê¸ˆ ë” ìˆ˜ì •ì´ í•„ìš”í•¨)

---

ResNetë„ ì¸µì„ ê¹Šê²Œí•˜ì—¬ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚´ê³ ì í•˜ëŠ” êµ¬ì¡°ì´ë‹¤
í•˜ì§€ë§Œ ì¸µì„ ê¹Šê²Œ ìŒ“ì„ ìˆ˜ë¡ Gradient Vanishing ë¬¸ì œê°€ ë°œìƒí–ˆìœ¼ë©°, ì•„ë˜ì˜ ê·¸ë¦¼ì²˜ëŸ¼ ì¸µì´ ê¹Šì–´ì§ˆ ìˆ˜ë¡ í•™ìŠµì´ ì˜ ë˜ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
ê·¸ëŸ°ë° ì—¬ê¸°ì„œ

![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/0ce6640b-0a83-45c4-8713-4f29425f10c6)

ì´ì— ResNet ì €ìë“¤ì˜ í•µì‹¬ ì•„ì´ë””ì–´ëŠ” Residual Blockì´ë‹¤.

![image](https://github.com/SangHyun014/SangHyun014.github.io/assets/87685922/3bfb647f-42aa-4fca-8677-025686230805)

ìœ„ì˜ ê·¸ë¦¼ì²˜ëŸ¼ ì¼ì¢…ì˜ ì§€ë¦„ê¸¸ì„ ë§Œë“¤ì–´ Gradient Vanishing ë¬¸ì œë¥¼ í•´ê²°í•˜ë©´ì„œ ì¸µì„ ê¹Šê²Œ ìŒ“ì„ìˆ˜ ìˆê²Œ ë˜ëŠ”ê²ƒì´ë‹¤.

ResNet ì› ë…¼ë¬¸ì—ì„œëŠ” ì´ë¥¼ ì–´ë–¤ ì´ë¡ ì„ ë°”íƒ•ìœ¼ë¡œ ê²°ê³¼ë¥¼ ì°¾ê¸°ë³´ë‹¨, ê²½í—˜ì  ë°”íƒ•ì´ ì»¸ë‹¤.

ë”°ë¼ì„œ ëª‡ ì¸µì´ Optimal depthì¸ì§€ëŠ” ì•Œ ìˆ˜ê°€ ì—†ë‹¤.

### Reference

---

[LeNet â€” Organize everything I know documentation (oi.readthedocs.io)](https://oi.readthedocs.io/en/latest/computer_vision/cnn/lenet.html)

[AlexNetì˜ ì´í•´ (velog.io)](https://velog.io/@lighthouse97/AlexNet%EC%9D%98-%EC%9D%B4%ED%95%B4)

[CNN ì£¼ìš” ëª¨ë¸ë“¤ Â· ratsgo's blog](https://ratsgo.github.io/deep%20learning/2017/10/09/CNNs/)

[[CNN ì•Œê³ ë¦¬ì¦˜ë“¤] GoogLeNet(inception v1)ì˜ êµ¬ì¡° by bskyvision.com](https://bskyvision.com/entry/CNN-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%EB%93%A4-GoogLeNetinception-v1%EC%9D%98-%EA%B5%AC%EC%A1%B0)

[Auxiliary classifierë€? / GoogLeNetì—ì„œ Auxiliary classifierë¥¼ ì‚¬ìš©í•œ ì´ìœ ? :: Technical Support (tistory.com)](https://technical-support.tistory.com/87)
